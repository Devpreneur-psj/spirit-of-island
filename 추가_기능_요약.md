# Aether Island 추가 기능 확장 요약

## 구현 완료된 추가 기능

### 1. 마정령 관리 기능 확장

#### 치료 기능
- ✅ `POST /api/v1/spiritlings/{id}/heal` - 마정령 치료하기
- 건강 상태 +25, 체력 스탯 +2, 행복도 +5, 경험치 +2
- 레벨 업 체크 및 성장 단계 업데이트 포함

#### 씻기기 기능
- ✅ `POST /api/v1/spiritlings/{id}/clean` - 마정령 씻기기
- 청결도 +30, 행복도 +10, 건강 상태 +5, 경험치 +2
- 레벨 업 체크 및 성장 단계 업데이트 포함

#### 훈련 기능
- ✅ `POST /api/v1/spiritlings/{id}/train?stat_type={type}` - 마정령 훈련하기
- 스탯 타입별 훈련 (health, agility, intelligence, friendliness, resilience, luck)
- 에너지 -20 소모, 선택한 스탯 +3, 경험치 +10
- 레벨 업 체크 및 성장 단계 업데이트 포함

### 2. 아이템 시스템

#### 아이템 상점
- ✅ `GET /api/v1/items` - 아이템 목록 조회
- ✅ `GET /api/v1/items/{id}` - 아이템 상세 조회
- ✅ 프론트엔드 아이템 상점 UI 구현
- 아이템 타입별 아이콘 표시
- 희귀도별 색상 구분 (common, rare, epic, legendary)

#### 아이템 구매
- ✅ `POST /api/v1/user-items/{item_id}/buy?quantity={quantity}` - 아이템 구매
- 코인 소모하여 아이템 구매
- 사용자 인벤토리에 추가
- 구매 후 코인 자동 업데이트

#### 아이템 사용
- ✅ `POST /api/v1/user-items/{item_id}/use` - 아이템 사용
- 마정령에게 아이템 효과 적용
- 스탯 또는 상태 증가
- 경험치 +2 (아이템당)
- 레벨 업 체크 및 성장 단계 업데이트 포함

#### 인벤토리
- ✅ `GET /api/v1/user-items` - 사용자 아이템 목록 조회
- ✅ 프론트엔드 인벤토리 UI 구현
- 보유 아이템 목록 표시
- 아이템 사용 기능

#### 초기 아이템 데이터
- ✅ `python init_items.py` - 초기 아이템 데이터 생성 스크립트
- 기본 사료, 고급 사료, 비타민, 치료 키트, 장난감, 훈련 도구 등
- 8종류의 아이템 자동 생성

### 3. 대회 시스템

#### 대회 목록 및 상세
- ✅ `GET /api/v1/competitions` - 대회 목록 조회 (upcoming, active만)
- ✅ `GET /api/v1/competitions/{id}` - 대회 상세 조회

#### 대회 참가
- ✅ `POST /api/v1/competitions/{id}/enter` - 대회 참가
- 대회 상태 확인 (active만 참가 가능)
- 마정령 소유권 확인
- 중복 참가 방지
- 대회 타입별 점수 계산:
  - 경주 (race): 민첩 70% + 운 30%
  - 퍼즐 (puzzle): 지능 80% + 근성 20%
  - 전투 (battle): 체력 40% + 근성 30% + 민첩 30%
  - 코디 (fashion): 친근함 60% + 운 40%

#### 대회 랭킹
- ✅ `GET /api/v1/competitions/{id}/ranking` - 대회 랭킹 조회
- 점수 순위대로 상위 10명 조회
- 랭킹 자동 업데이트

### 4. 마정령 성장 시스템

#### 레벨 업 시스템
- ✅ 레벨 업 체크 함수 (`_check_level_up`)
- 경험치가 레벨 * 100 이상이면 레벨 업
- 레벨업 시 모든 스탯 +1
- 경험치 초기화

#### 성장 단계 시스템
- ✅ 레벨에 따른 성장 단계 자동 업데이트:
  - 레벨 1-4: 알 (egg)
  - 레벨 5-14: 유아 (infant)
  - 레벨 15-24: 청소년 (adolescent)
  - 레벨 25-39: 성체 (adult)
  - 레벨 40-49: 초월체 (transcendent)
  - 레벨 50+: 노년 (elder)

#### 경험치 획득
- 먹이주기: 경험치 +2
- 놀기: 경험치 +3
- 치료: 경험치 +2
- 씻기기: 경험치 +2
- 훈련: 경험치 +10
- 아이템 사용: 경험치 +2 (아이템당)

### 5. 프론트엔드 UI 개선

#### 탭 메뉴 시스템
- ✅ 마정령, 상점, 인벤토리 탭 추가
- 탭 전환 애니메이션
- 활성 탭 표시

#### 아이템 상점 UI
- ✅ 아이템 목록 표시
- 아이템 타입별 아이콘
- 희귀도별 색상 구분
- 구매 버튼 및 코인 표시
- 구매 중 로딩 상태

#### 인벤토리 UI
- ✅ 보유 아이템 목록 표시
- 아이템 수량 표시
- 아이템 사용 버튼
- 사용 중 로딩 상태

#### 행동 패널 개선
- ✅ 치료, 씻기기 버튼 추가
- 훈련 기능 추가
- 스탯 선택 드롭다운
- 에너지 부족 시 경고 메시지

## API 엔드포인트 추가

### 마정령 관리
- `POST /api/v1/spiritlings/{id}/heal` - 치료하기
- `POST /api/v1/spiritlings/{id}/clean` - 씻기기
- `POST /api/v1/spiritlings/{id}/train?stat_type={type}` - 훈련하기

### 아이템
- `GET /api/v1/user-items` - 사용자 아이템 목록
- `POST /api/v1/user-items/{item_id}/buy?quantity={quantity}` - 아이템 구매
- `POST /api/v1/user-items/{item_id}/use` - 아이템 사용

### 대회
- `GET /api/v1/competitions/{id}/ranking` - 대회 랭킹 조회
- `POST /api/v1/competitions/{id}/enter` - 대회 참가 (개선)

## 다음 단계 (추가 구현 필요)

### 1. 마정령 자율 행동 AI 백그라운드 작업
- [ ] 주기적 상태 업데이트 (배고픔, 행복도, 에너지 감소)
- [ ] 자율 행동 실행 (먹기, 놀기, 잠자기 등)
- [ ] 행동 로그 저장 및 표시
- [ ] 날씨 시스템 연동

### 2. 대회 시스템 확장
- [ ] 대회 생성 기능 (관리자)
- [ ] 대회 보상 지급 시스템
- [ ] 대회 종료 및 결과 처리
- [ ] 시즌 랭킹 시스템

### 3. UI/UX 개선
- [ ] 행동 로그 UI (말풍선 형태)
- [ ] 마정령 애니메이션 개선
- [ ] 레벨 업 알림
- [ ] 성장 단계 변화 애니메이션
- [ ] 대회 화면 UI

### 4. 추가 기능
- [ ] 친구 시스템
- [ ] 마을 방문 기능
- [ ] 채팅 시스템
- [ ] 이벤트 시스템
- [ ] 업적 시스템

## 사용 방법

### 초기 아이템 데이터 생성
```bash
cd backend
python init_items.py
```

### 아이템 구매
1. 상점 탭에서 아이템 선택
2. 구매 버튼 클릭
3. 코인 차감 및 인벤토리에 추가

### 아이템 사용
1. 인벤토리 탭에서 아이템 선택
2. 사용 버튼 클릭
3. 선택한 마정령에게 효과 적용

### 마정령 훈련
1. 마정령 선택
2. 행동 패널에서 훈련 섹션
3. 스탯 선택 및 훈련하기 버튼 클릭
4. 에너지 -20, 선택한 스탯 +3

### 대회 참가
1. 대회 목록에서 대회 선택
2. 마정령 선택
3. 참가 버튼 클릭
4. 점수 계산 및 랭킹 업데이트

## 참고 사항

- 모든 행동은 경험치를 획득하며 레벨 업 가능
- 레벨 업 시 성장 단계가 자동으로 변경됨
- 아이템 사용 시에도 경험치 획득 및 레벨 업 가능
- 대회 점수는 마정령의 스탯에 따라 자동 계산됨
- 대회 랭킹은 점수 순위대로 자동 업데이트됨

